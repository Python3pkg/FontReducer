#!/usr/bin/env python
# -*- coding: utf-8 -*-
from __future__ import (print_function, division, absolute_import, unicode_literals, )


import click


@click.command()
@click.argument('font_path')
@click.option('-o', '--output', default='', help='output file path')
@click.option('--is-codepoint', default=False, type=click.BOOL, help='pass the value as code points')
def fontreducer(font_path, output, is_codepoint):
    '''
    Example:

        $ echo 'words_to_reduce' | fontreducer PATH_TO_FILE -o PATH_TO_OUTPUT
    '''
    from sys import stdin
    chars = unicode(stdin.read(), 'utf-8')
    from fontreducer import format_codepoint_texts, chars_to_codepoints, generate_subset
    if is_codepoint:
        code_pointes = format_codepoint_texts(chars)
    else:
        code_pointes = chars_to_codepoints(chars)

    font = generate_subset(code_pointes, font_path)
    if output:
        font.save(output)
        # font.generate(output)


if __name__ == "__main__":
    import sys
    reload(sys)
    sys.setdefaultencoding('utf-8')

    fontreducer()
